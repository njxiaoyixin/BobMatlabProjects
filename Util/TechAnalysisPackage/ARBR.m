function [AR,BR]=ARBR(Open,High,Low,Close,Length)
%---------------此函数用来计算ARBR指标(人气和买卖意愿指标)-----------------
%----------------------------------编写者--------------------------------
%Lian Xiangbin(连长,785674410@qq.com),DUFE,2014
%----------------------------------参考----------------------------------
%[1]姜金胜.指标精萃：经典技术指标精解与妙用.东华大学出版社,2004年01月第1版
%[2]浙商证券.技术指标优化择时：10年30倍收益,2010-12-23
%[3]来自网络.24个基本指标精粹讲解
%[4]同花顺.ARBR指标算法
%----------------------------------简介----------------------------------
%AR指标又叫人气指标,BR指标又叫买卖意愿指标，它们是衡量市场上多空双方力
%量对比变化的最重要指标。它们既可以单独使用，更多情况下是一同使用，是一
%种中长期技术分析工具。
%市场上的每一个交易日都要进行多空力量的较量。正确、全面地反映每一个
%交易日或某一段时期内的多空双方力量的对比。在一个交易日或某一段时期，多
%空双方的优势是不断地交替着，双方都有可能在一定时期内占据优势。如果一定
%时期内多方力量占据优势，价格将会不断上升；如果一定时期内空方力量占据优
%势，价格则会不断下跌；多空双方力量如果大致平衡，价格在会在某一区域内窄
%幅波动。而市场上多方力量大，则买方气势就会比较强、卖方气势就会减弱；市
%场上空方力量大，则卖方气势就会比较强、买方气势就会衰弱。 
%因此，价格走势的变动主要是由供求双方买卖气势和多空力量的对比造成的。 
%正如每个事物都有一个开始的地方一样，在市场上，多空双方的争斗都是从
%某一个均衡价位区（或基点）开始的。价格在这个均衡区上方，说明多方力量占
%优势；价格在这个平衡区下方，说明空方力量占优势。随着市场的进一步发展，
%价格会向上或向下偏离这一平衡价位区（或基点），价格偏离得越大，说明力量
%越大，偏离得越小，说明力量越小。因此。利用各种价格之间的关系，找到
%这个平衡价位区（或基点），对研判多空力量的变化起着重要的作用。而 AR、BR
%指标就是根据开盘价、收盘价、最高价和最低价之间的关系来分析多空力
%量的对比，预测价格的未来走势的。 
%AR指标是反映市场当前情况下多空双方力量发展对比的结果。它是以当日的开
%盘价为基点。与当日最高价、最低价相比较，依固定公式计算出来的强弱指标。 
%BR指标也是反映当前情况下多空双方力量争斗的结果。不同的是它是以前一日
%的收盘价为基础，与当日的最高价、最低价相比较，依固定公式计算出来的强弱
%指标。
%----------------------------------基本用法------------------------------
%1)AR一般以100为中心，当AR高于150时，表明最近一段时期内价格开盘走高的幅度
%远大于走低的幅度，涨幅可能也较大，处于超买状态，是卖出信号。当AR低于50
%时，处于超卖状态，是买入信号
%2)BR一般要和AR配合使用
%3)可以将AR、BR的临界值分别为60/140和50/150
%4)更多具体用法，请查看参考
%----------------------------------调用函数------------------------------
%[AR,BR]=ARBR(Open,High,Low,Close,Length)
%----------------------------------参数----------------------------------
%Open-开盘价序列
%High-最高价序列
%Low-最低价序列
%Close-收盘价序列
%Length-计算AR和BR所考虑的时间周期，常用26个Bar
%----------------------------------输出----------------------------------
%AR-人气指标
%BR-买卖意愿指标

AR=zeros(length(Open),1);
BR=zeros(length(Open),1);
AR(1:Length)=100;
BR(1:Length)=100;
for i=Length+1:length(Open)
AR(i)=sum(High(i-Length+1:i)-Open(i-Length+1:i))/...
    sum(Open(i-Length+1:i)-Low(i-Length+1:i))*100;
Temp1=High(i-Length+1:i)-Close(i-Length:i-1);
Temp1(Temp1<0)=0;
Temp2=Close(i-Length:i-1)-Low(i-Length+1:i);
Temp2(Temp2<0)=0;
BR(i)=sum(Temp1)/sum(Temp2)*100;
end
AR(AR==inf)=100;
BR(BR==inf)=100;
end

